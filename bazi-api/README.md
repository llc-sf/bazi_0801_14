# å…«å­—æ’ç›˜ API (é‡æ„ç‰ˆ)

åŸºäº 8Char-Uni-App-master çš„ lunar-javascript é€»è¾‘é‡æ„çš„ä¸“ä¸šå…«å­—æ’ç›˜ APIã€‚

## ğŸš€ ç‰¹æ€§

- **å®Œæ•´å…«å­—è®¡ç®—**: å¹´æœˆæ—¥æ—¶å››æŸ±æ’ç›˜
- **åç¥å…³ç³»**: åŸºäºä¼ ç»Ÿå‘½ç†å­¦çš„åç¥è®¡ç®—
- **å¤§è¿æµå¹´**: å®Œæ•´çš„å¤§è¿æµå¹´æ¨ç®—
- **å¤ç±å‚è€ƒ**: ç§°éª¨ç®—å‘½ç­‰ä¼ ç»Ÿå‘½ç†å‚è€ƒ
- **å¤šæ¥å£æ”¯æŒ**: å…¼å®¹å‰ç«¯é¡¹ç›®çš„å¤šä¸ªæ¥å£éœ€æ±‚

## ğŸ“‹ API æ¥å£

### 1. è·å–å…«å­—åŸºæœ¬ä¿¡æ¯
```http
POST /8char/get-info
Content-Type: application/json

{
  "datetime": "2023-05-15 10:30:00",
  "gender": 1,
  "sect": 1,
  "realname": "å¼ ä¸‰"
}
```

**å“åº”ç¤ºä¾‹:**
```json
{
  "data": {
    "realname": "å¼ ä¸‰",
    "gender": 1,
    "zodiac": "å…”",
    "constellation": "é‡‘ç‰›åº§",
    "top": {
      "year": "ç™¸",
      "month": "ä¸",
      "day": "ç”²",
      "time": "å·±"
    },
    "bottom": {
      "year": "å¯",
      "month": "å·³",
      "day": "åˆ",
      "time": "å·³"
    },
    "nayin": {
      "year": "é‡‘æ³Šé‡‘",
      "month": "ç ‚ä¸­åœŸ",
      "day": "ç ‚ä¸­é‡‘",
      "time": "å¤§æ—æœ¨"
    },
    "gods": ["æ­£å°", "ä¼¤å®˜", "é£Ÿç¥"]
  }
}
```

### 2. è·å–å¤ç±å‘½ä¹¦ä¿¡æ¯
```http
POST /8char/get-book
Content-Type: application/json

{
  "datetime": "2023-05-15 10:30:00",
  "gender": 1,
  "sect": 1
}
```

### 3. è·å–å¤§è¿æµå¹´é¢„æµ‹
```http
POST /8char/get-prediction
Content-Type: application/json

{
  "datetime": "2023-05-15 10:30:00",
  "gender": 1,
  "sect": 1
}
```

**å“åº”ç¤ºä¾‹:**
```json
{
  "data": {
    "dayunList": [
      {
        "startYear": 2031,
        "startAge": 8,
        "pillar": "æˆŠåˆ",
        "shishen": "æ‰å®˜"
      }
    ],
    "yearList": [
      {
        "year": 2031,
        "pillar": "è¾›äº¥",
        "age": 8,
        "shishen": "å®˜å°"
      }
    ]
  }
}
```

### 4. è·å–æç¤ºä¿¡æ¯
```http
GET /8char/get-tips
```

### 5. è·å–ç‰ˆæœ¬ä¿¡æ¯
```http
GET /8char/get-version
```

## ğŸ› ï¸ æŠ€æœ¯æ¶æ„

### æ ¸å¿ƒæ¨¡å—

1. **LunarCalculator** (`lunar_calculator.py`)
   - å†œå†å…¬å†è½¬æ¢
   - å…«å­—å››æŸ±è®¡ç®—
   - çº³éŸ³ã€ç©ºäº¡è®¡ç®—

2. **ShishenCalculator** (`shishen_calculator.py`)
   - åç¥å…³ç³»è®¡ç®—
   - åŸºäºäº”è¡Œç”Ÿå…‹ç†è®º
   - æ”¯æŒå¤©å¹²åœ°æ”¯åç¥

3. **DayunCalculator** (`dayun_calculator.py`)
   - å¤§è¿æ’ç›˜è®¡ç®—
   - æµå¹´æ¨ç®—
   - æµæœˆè®¡ç®—

4. **BaziCalculator** (`bazi_calculator.py`)
   - ä¸»è®¡ç®—ç±»
   - é›†æˆæ‰€æœ‰åŠŸèƒ½æ¨¡å—

### æ•°æ®æ¨¡å‹

æ‰€æœ‰æ•°æ®ç»“æ„å®šä¹‰åœ¨ `data_models.py` ä¸­ï¼ŒåŒ…æ‹¬ï¼š
- è¯·æ±‚/å“åº”æ¨¡å‹
- å››æŸ±æ•°æ®ç»“æ„
- å¤§è¿æµå¹´æ•°æ®ç»“æ„
- å¸¸é‡å®šä¹‰

## ğŸ”§ å®‰è£…ä¸è¿è¡Œ

### å®‰è£…ä¾èµ–
```bash
pip install -r requirements.txt
```

### å¯åŠ¨æœåŠ¡
```bash
# å¼€å‘æ¨¡å¼
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000

# ç”Ÿäº§æ¨¡å¼
uvicorn app.main:app --host 0.0.0.0 --port 8000
```

### Docker éƒ¨ç½²
```bash
# æ„å»ºé•œåƒ
docker build -t bazi-api .

# è¿è¡Œå®¹å™¨
docker run -p 8000:8000 bazi-api
```

## ğŸ§ª æµ‹è¯•

è¿è¡Œæµ‹è¯•è„šæœ¬ï¼š
```bash
cd app
python test_api.py
```

## ğŸ“Š å‚æ•°è¯´æ˜

### æ€§åˆ«å‚æ•°
- `1`: ç”·
- `2`: å¥³

### æµæ´¾å‚æ•°
- `1`: æ™šå­æ—¶æ—¥æŸ±ç®—æ˜å¤©
- `2`: æ™šå­æ—¶æ—¥æŸ±ç®—å½“å¤©

### æ—¶é—´æ ¼å¼
- æ ¼å¼: `YYYY-MM-DD HH:MM:SS`
- ç¤ºä¾‹: `2023-05-15 10:30:00`

## ğŸ”„ ä¸å‰ç«¯çš„å¯¹åº”å…³ç³»

| å‰ç«¯æ¥å£ | åç«¯æ¥å£ | è¯´æ˜ |
|---------|----------|------|
| `GetInfo` | `/8char/get-info` | è·å–å…«å­—åŸºæœ¬ä¿¡æ¯ |
| `GetBook` | `/8char/get-book` | è·å–å¤ç±å‘½ä¹¦ä¿¡æ¯ |
| `GetPrediction` | `/8char/get-prediction` | è·å–å¤§è¿æµå¹´é¢„æµ‹ |
| `GetTips` | `/8char/get-tips` | è·å–æç¤ºä¿¡æ¯ |
| `GetVersion` | `/8char/get-version` | è·å–ç‰ˆæœ¬ä¿¡æ¯ |

## ğŸ“ˆ ç‰ˆæœ¬å†å²

### v2.0.0 (å½“å‰ç‰ˆæœ¬)
- åŸºäº 8Char-Uni-App-master é€»è¾‘é‡æ„
- æ”¯æŒå®Œæ•´çš„å…«å­—ã€åç¥ã€å¤§è¿è®¡ç®—
- æ–°å¢å¤šä¸ªä¸“ç”¨æ¥å£
- æ”¹è¿›æ•°æ®ç»“æ„å’Œå“åº”æ ¼å¼

### v1.0.0 (åŸç‰ˆæœ¬)
- åŸºç¡€å…«å­—è®¡ç®—åŠŸèƒ½
- å•ä¸€ `/bazi` æ¥å£

## ğŸ¤ å…¼å®¹æ€§

- ä¿ç•™åŸæœ‰ `/bazi` æ¥å£ä»¥ç¡®ä¿å‘åå…¼å®¹
- æ–°æ¥å£æ ¼å¼ä¸å‰ç«¯é¡¹ç›®å®Œå…¨å¯¹åº”
- æ”¯æŒå‰ç«¯é¡¹ç›®çš„æ‰€æœ‰è®¡ç®—éœ€æ±‚

## ğŸ“ è®¸å¯è¯

æœ¬é¡¹ç›®éµå¾ªåŸé¡¹ç›®çš„å¼€æºåè®®ï¼Œä»…ä¾›å­¦ä¹ ç ”ç©¶ä½¿ç”¨ã€‚